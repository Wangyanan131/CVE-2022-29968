# CVE-2022-29968
Exploit for CVE-2022-29968

## Patch Commit
[The patch commit](https://github.com/torvalds/linux/commit/32452a3eb8b64e01e2be717f518c0be046975b9d)

## Exploit
### Requirements
- SMAP/ SMEP need to be off
- `/dev/sr0` needs to be readable by an unprivileged user

Tested in a Busybox install (without KVM) with 128M of RAM:

`$QEMU -m 128M -kernel $KERNEL -initrd $INITRD $FLAGS -append "console=ttyS0 nokaslr no_hash_pointers ftrace_dump_on_oops -nographic"`

initramfs `init`:

```
#!/bin/sh
/bin/busybox --install -s
mount -t proc none /proc
mount -t sysfs sysfs /sys
mount -t tracefs nodev /sys/kernel/tracing
mount -t debugfs none /sys/kernel/debug
mkdir -p /tmp  && mount -t tmpfs tmpfs /tmp
touch /tmp/test
mount -t devtmpfs none /dev
chmod -R 0777 /dev/sr0
su jravi
exec setsid sh -c 'exec sh </dev/ttyS0 >/dev/ttyS0 2>&1'
```

Kernel was compiled with `make defconfig` for `x86_64` with some extra tracing features enabled.

### Running it
1. Compile with `make`
1. `./spray`
1. `./exploit`
